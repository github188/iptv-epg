<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0">
    <meta name="page-view-size" content="1280*720">
    <title>入口页面</title>
    <link rel="stylesheet" href="./styles/font-awesome.min.css">
    <!-- <link rel="stylesheet" href="./styles/bootstrap.min.css"> -->
    <style>
        body {
            background-color: white;
            padding: 10px;
        }

        .test-tag {
            position: absolute;
            right: 10px;
            bottom: 20px;
            background-color: red;
            color: white;
            font-size: 12px;
            border-radius: 5px;

            padding: 5px;

            z-index: 50;
        }

        .container a {
            text-decoration: none;
        }

        #refresh {
            position: absolute;
            left: 10px;
            bottom: 20px;
            width: 80px;
            background-color: green;
            border-radius: 3px;
            text-align: center;
            color: white;
        }
    </style>
</head>
<body>
    <div id="container" class="container">
        <!-- 链接列表 -->
    </div>
    <button id="refresh"><i class="fa fa-refresh" aria-hidden="true"></i> 刷新</button>
    <span class="test-tag">Entry Page(Testing...)</span>
    <script src="./cfg/config.js"></script>
    <script>
        function $(id) {
            return document.getElementById(id);
        }

        function gotoEPG() {
            window.location.href = '../portal.html';
        }

        $('refresh').onclick = function (e) {
            window.document.location.href = window.document.location.href;

            console.log(e.target);
            // if (e.target)
        }

        function init() {
            
            var linkHtml = '',
                links = GCL_TEST_LINKS;

            for ( var i = 0, len = links.length; i < len; i++ ) {
                linkHtml += '<br>' + links[i].icon + '&nbsp;&nbsp;'
                    + '<a href="' + links[i].link + '">'
                    + links[i].text 
                    + '</a>';
            }

            $('container').innerHTML = linkHtml;

        };

        init();


        function GCL(id) {
            
            this.no = 1;
            this.div = null;
            this.id = id || 'gcl-test-div';
            this.switch = false;
            this.created = false;
            this.style = {
                position: 'absolute',
                right: '0px',
                top: '0px',
                backgroundColor: 'gray',
                height: '100%',
                width: '200px',
                fontSize: '16px',
                textAlign: 'left'
            };
            this.split = '';

            this.setSplit = function (split) {
                this.split = split;
            }

            this.create = function () {
                var info = document.createElement('div');
                info.id = this.id;

                for (var prop in this.style) {
                    info.style[prop] = this.style[prop];
                }
                
                document.body.appendChild(info);

                this.div = info;

                this.created = true;
                return this;
            };

            this._print = function (str) {
                this.div.innerHTML += '[' + (this.split ? this.split : this.no++) + ']' + str + '<br>';
            };

            this.print = function (obj, desc, isValue) {
                
                if (!this.switch) { return false; }

                var content = '';
                var tmp = null;

                if (Array.isArray(obj)) {
                    for (var i = 0; i < obj.length; i++) {
                        tmp = obj[i];

                        if (tmp.isValue) {
                            content = tmp.desc + ': ' + tmp.key;
                        } else {
                            content = tmp.key ? tmp.desc + ': true' : tmp.desc + ': false';
                        }

                        this._print(content);
                    }
                } else {
                    this._print(
                        isValue
                            ? desc + ':' + JSON.stringify(obj)
                            : obj 
                                ? desc + ': true' 
                                : desc + ': false'
                    );
                }
            };

            this.append = function (key, value) {
                this.no++;

                this._print(key + ': ' + value); 

                return this;  
            };

            this.open = this.start = this.on = function () {
                
                if (!this.created) {
                    this.create();
                }

                this.switch = true;
            };

            this.close = this.off = function () {

                this.switch = false;
                this.div.innerHTML = '';
                // document.body.removeChild(this.div);
            }
        }

        var gcl = new GCL();
        gcl.open();
        var iPanel = {};

        gcl.print(
            [
                {key: iPanel, desc: 'ipanel'},
                {key: iPanel.mainFrame, desc: 'ipanel.mainFrame'},
                {key: Authentication, desc: 'Authentication'},
                {key: Authentication.CTCGetConfig('UserID'), desc: 'UserID', isValue: true}
            ]
        );


        window.onkeydown = function (event) {
            var keycode = event.which ? event.which : event.keycode;

            switch (keycode) {
                case 8:
                    gcl.append('keycode', 8);
                    gotoEPG();
                    return false;
                break;
                default: return true; break;
            }
        }

    </script>
</body>
</html>